import { AdminUser, AdminLoginCredentials } from './admin-user.type';
import { AdminRole } from './admin.roles';

/**
 * Контракт провайдера авторизации администраторов.
 * 
 * Определяет интерфейс для работы с авторизацией в админ-панели.
 * Реализация будет предоставлена позже (Firebase Auth или NextAuth).
 * 
 * Все методы должны быть реализованы в конкретном провайдере.
 */
export interface AdminAuthProvider {
  /**
   * Выполняет вход администратора в систему.
   * 
   * @param credentials - Учетные данные для входа (email и password)
   * @returns Promise с данными авторизованного администратора
   * @throws Ошибка, если учетные данные неверны или учетная запись неактивна
   * 
   * TODO: Реализовать логику аутентификации
   * TODO: Определить формат ошибок авторизации
   */
  login(credentials: AdminLoginCredentials): Promise<AdminUser>;

  /**
   * Выполняет выход администратора из системы.
   * 
   * Очищает сессию и токены авторизации.
   * 
   * @returns Promise, который резолвится после успешного выхода
   * 
   * TODO: Реализовать логику выхода
   * TODO: Определить, нужно ли уведомлять backend о выходе
   */
  logout(): Promise<void>;

  /**
   * Получает данные текущего авторизованного администратора.
   * 
   * @returns Promise с данными администратора или null, если пользователь не авторизован
   * 
   * TODO: Реализовать получение данных из сессии/токена
   */
  getCurrentUser(): Promise<AdminUser | null>;

  /**
   * Проверяет, авторизован ли администратор в системе.
   * 
   * @returns Promise с булевым значением: true, если пользователь авторизован
   * 
   * TODO: Реализовать проверку наличия валидной сессии/токена
   */
  isAuthenticated(): Promise<boolean>;

  /**
   * Проверяет, имеет ли текущий администратор указанную роль или выше.
   * 
   * @param role - Роль для проверки
   * @returns Promise с булевым значением: true, если роль достаточна
   * 
   * TODO: Реализовать проверку роли с учетом иерархии
   */
  hasRole(role: AdminRole): Promise<boolean>;

  /**
   * Обновляет данные текущего администратора.
   * 
   * Используется для синхронизации данных после изменений на backend.
   * 
   * @returns Promise с обновленными данными администратора
   * 
   * TODO: Реализовать обновление данных из backend
   */
  refreshUser(): Promise<AdminUser | null>;
}
