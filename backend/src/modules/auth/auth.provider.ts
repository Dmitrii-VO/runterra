/**
 * Интерфейс провайдера авторизации
 * 
 * Определяет контракт для работы с различными системами авторизации
 * (Firebase, Auth0, custom и т.д.) без привязки к конкретной реализации.
 */

/**
 * Данные пользователя из системы авторизации
 */
export interface AuthUser {
  /** Уникальный идентификатор пользователя */
  uid: string;
  /** Email пользователя (если доступен) */
  email?: string;
  /** Email подтверждён */
  emailVerified?: boolean;
  /** Имя пользователя (если доступно) */
  displayName?: string;
  /** URL фото профиля (если доступно) */
  photoURL?: string;
}

/**
 * Результат проверки токена
 */
export interface TokenVerificationResult {
  /** Успешна ли проверка */
  valid: boolean;
  /** Данные пользователя (если токен валиден) */
  user?: AuthUser;
  /** Сообщение об ошибке (если токен невалиден) */
  error?: string;
}

/**
 * Интерфейс провайдера авторизации
 * 
 * Абстракция для работы с различными системами авторизации.
 * Позволяет легко заменить реализацию без изменения кода, использующего авторизацию.
 */
export interface AuthProvider {
  /**
   * Проверка токена авторизации
   * 
   * @param token - Токен авторизации из заголовка Authorization
   * @returns Результат проверки с данными пользователя или ошибкой
   */
  verifyToken(token: string): Promise<TokenVerificationResult>;
}
